# LSB와 스테가노그래피
======================
## LSB란?
> Least Significant Bit, 최하위 비트라고 하며, 이진 정수에서 짝수인지 홀수인지를 결정하는 단위값이 되는 비트 위치이다.  
가장 적은 숫자를 오른쪽에 기록하는 자리 표기법의 규정 때문에 "right-most bit"라고 부르기도 한다.  

> 최하위 비트들은 최하위 비트를 포함하는 여러 자리의 숫자들을 말한다.  
숫자를 조금만 증감하여도 민감하게 바뀌는 유용한 특징을 가지고 있다.



## 스테가노그래피에서 LSB가 쓰이는 경우  
> 주로 _변조_ 방식에서 쓰인다.  
가장 일반적인 방법은 최하위 비트인 LSB를 변조하는 방법인데, 주로 _JPEG_, *BMP*같은 24비트 이미지파일에 적용된다.  
24비트(빨강 8, 초록 8, 파랑 8)가 하나의 색을 표현하기 때문에 이미지가 변조되어도 사람의 눈으로 알아채기 어렵다.

> 장점: 비밀 정보를 손쉽게 삽입할 수 있고 커버이미지의 종류에 따라 커버 이미지 크기의 최대 약 50%까지도 비밀정보를 삽입할 수 있다.  
단점: 이미지의 변환에 약하다.

## LSB 조작에 따른 이미지 변화
> 상위 비트가 바뀔수록 육안으로 인식할 수 있는 색상의 변화가 크고 하위 비트로 내려갈수록 그 변화가 작아진다.  

+ 4비트: 전체적인 외형은 크게 변경되지 않으나 색감과 윤곽선의 현저한 왜곡이 나타난다.  
+ 2비트: 언뜻 보기에는 이미지의 외형, 색감, 윤곽선이 동일한 것처럼 보이지만 비트가 조작된 이미지를 확대해서 보면 변경된 부분을 육안으로 볼 수 있다.  
+ 1비트: 확대된 이미지에서도 변경된 부분을 식별하기 어렵다  

> LSB를 이용한 이미지 스테가노그래피의 경우 이미지에 관계없이 일괄적인 정보은닉을 위해 LSB-1비트를 이용한다.

## 분석 방법
1. GIF 포맷  
* GIF는 2^24개의 24비트 컬러값들 중에서 255개의 컬러값만을 임의로 뽑은 파렛트를 인덱스해서 컬러를 표현한다.
* 실제로 LSB에다 데이터를 인코딩할 경우 이 파렛트에 대응되는 인덱스값이 달라져서 실제 스테가노그래피화된 파일이 많이 달라보이게 된다. 그렇기에 활용성이 제한적이고 문제로 나올 경우 수준 또한 굉장히 낮다. 
* GIF 포맷을 사용한다 하더라도 회색계열의 단조로운 색채의 그림에 적은 데이터를 숨기는 정도다.

2. BMP, PNG 포맷  
* 직접적인 각각 픽셀에 RGB값들을 인코딩하는 방식을 하기 때문에 LSB에 적합하다. 
* 하지만 statistical attack이나 visualization attack 등을 통해 쉽게 숨겨진 파일 유무를 판별할 수 있어 판별 후 헥스 값을 분석하는 방법이나 Stegsolve 등의 간단한 툴의 활용만으로 풀 수 있다.

3. JPG/JPEG 방식  
* JPG/JPEG는 압축 과정에서 단순 LSB로 파일을 삽입하게되면 상당수가 변질되어 디코딩이 불가능하므로 여러 복잡한 방식을 통하여 이루어지므로 일반적인 탐지를 힘들게 만든다. 
* 분석과정은 심히 복잡하여 툴 활용이 추천되고, 복잡성으로 인해 스테가노 문제로 거의 나오지 않는다.  

## 여러 가지 기법

### 랜덤한 색상을 선별해 기밀 메세지를 숨기는 방법
1. Pseude-random LSB 기법 
+ 원본 그림이 없을 경우 일반적인 분석 기법으로는 탐지가 어려움
2. Selected LSB
+ RGB 중 하나를 선택하여 해당 색상에 기밀 메세지를 숨기는 방법
3. Image Downgrading
+ 커버이미지의 하위 4비트를 기밀 메세지의 상위 4비트로 교체하는 방법
+ 은닉할 메세지가 어느정도 왜곡되어 전달되나 내용파악에 큰 문제가 없고, 커버미디어 용량의 절반에 가까운 크기의 메세지를 은닉할 수 있다.(그러나 의심받기 쉬워서 자주 사용하지 않는다)

### LSB 필터링
1. Enhanced LSb
+ 각 픽셀의 LSB가 1이면 255,0이면 0으로 하는 기법
+ 필터링 바이트 분포가 매우 랜덤하면 특정파일을 삽이했다고 유추가 가능하다.
2. Gray bit
+ 각 픽셀의 RGB 색상이 같을 경우 검정색, 다른 경우 흰색으로 변환한다.